100 'Demo des commandes RSX
110 '(C) AMSTRAD 100% & Elmar Krieger
120 MEMORY &5FFF:MODE 0:LOAD "sprites.dat", &6000 : LOAD "sprmcode",&9800
130 'Initialiser
140 CALL &9800:|INIT:MODE O:hgfa(1)=0:hgfa(2)=13:hgfa(3)=9:hgfa(4)=3:spfa(1)=26:spfa(2)=2:spfa(3)=15:v=1:GOSUB 310
150 LOCATE 1,1:PRINT"UN CIMETIERE....":FOR a=0 TO 60 STEP 4:|PUTBKG,0,a,208:NEXT:b=0:FOR a=6 TO 48 STEP 14:x(b)=a:y(b)=199:b=b+1:|PUTBKG, 1,a, 199:|PUTBKG,2,a,208:NEXT:h(0)=85:h(1)=40:h(2)=60:h(3)=75:GOSUB 300
160 LOCATE 1,1:PRINT"MAL S'APPROCHE..":FOR a=0 TO 3:FOR b=0 TO h(a):CALL &BD19:|PUTBKG,1,x(a),y(a):y(a)=y(a)-2:NEXT:NEXT:GOSUB 300
170 LOCATE 1,1:PRINT"LE GRAND SAUVEUR":x=28:y=177:r=0:FOR a=0 TO y:|PUTSWF,3,r,x,a:NEXT
180 LOCATE 1,1:PRINT"CURS.,COPY,SPACE"
190 |PUTSWF,3,r,x,y:x2=x
200 x=x-INKEY(8)+INKEY(1)+(x>53)-(x<2):y=y-4*INKEY(0)+4*INKEY(2)+4*(y>193)-4*(y<8):IF x2=x THEN 210 ELSE IF x2<x THEN r=0 ELSE r=1
210 IF NOT INKEY(9) THEN GOSUB 310
220 IF INKEY(47) THEN 190
230 |REMSPR,3,x,y
240 LOCATE 1,1:PRINT" IL VIENT.... ":|PUTSPR,3,0,2,191:GOSUB 300
250 v=0:r=0:GOSUB 310:x=24:GOSUB 290:WHILE INKEY$=":FOR a=130 TO 20 STEP -4:IPUTSPR,4,r,x,a:NEXT:FOR a=0 TO 10:|PUTSPR,4,r,x,20:r=r XOR 1:FOR b=1 TO 200:NEXT:NEXT:GOSUB 310:FOR a=20 TO 130 STEP 4:|PUTSPR,4,r,x,a:NEXT:WEND
260 v=O:GOSUB 310:LOCATE 1,1:PRINT "C'EST COURAGEUX!":GOSUB 300
270 FOR a=191 TO 6 STEP -1:|PUTSWF,3,0,2,a:NEXT:FOR a=2 TO 28:|PUTSWF,3,O,a,6:NEXT:FOR A=6 TO 94 STEP 4:|PUTSWF,3,0,28,a:NEXT:FOR a=130 TO 250 STEP 4:POKE &9704,251-a:|PUTSWF,3,0,28,a-36,4,0,x,a:NEXT:FOR A=214 TO 6 STEP -1:|PUTSWF,3,0,28,a:NEXT
280 LOCATE 1,1:PRINT" LA VICTOIRE ? ":GOSUB 300:LOCATE 1,1:PRINT "AAAARRRRGGHH!!!!":OUT &BC00,8:OUT &BD00,1:x=4:GOSUB 290:x=24:GOSUB 290:x=44:GOSUB 290:OUT &BD00,O:LOCATE 1,1:PRINT "NO HAPPY END....":GOSUB 300:GOTO 370
290 FOR a=250 TO 130 STEP -4:POKE &9704,251-a:|PUTSWF,4,0,x,a:NEXT:RETURN
300 WHILE INKEY$<>":WEND:CALL &BB18:RETURN
310 'Couleurs
320 v=v XOR 1:IF v=1 THEN 350
330 'Sprites devant
340 FOR a=0 TO 3:INK a,hgfa(a+1):NEXT:FOR a=4 TO 12 STEP 4:FOR b=a TO a+3:INK b,spfa(a/4):NEXT:NEXT:RETURN
350 'Sprites derriere
360 FOR a=1 TO 3:FOR b=1 TO 3:INK a*4+b,hgfa(b+1):NEXT:NEXT:FOR a=4 TO 12 STEP 4:INK a,spfa(a/4):NEXT:RETURN
370 'Fin (reset CRTC)
380 OUT &BC00,1:OUT &BD00,40
390 OUT &BC00,2:OUT &BD00,46
400 OUT &BC00,6:OUT &BD00,25
410 OUT &BC00,7:OUT &BD00,30
420 END
